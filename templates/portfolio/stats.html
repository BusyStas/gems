{% extends "base.html" %}

{% block title %}Portfolio Statistics - {{ config.SITE_NAME }}{% endblock %}

{% block content %}
<div class="hero-section">
    <h1>üìä Portfolio Statistics</h1>
    <p>Your gem collection analytics and insights</p>
</div>

<div class="content-section">
    {% if stats and stats.total_items > 0 %}
    <div class="card-grid">
        <div class="card">
            <h3>Total Holdings</h3>
            <p style="font-size: 2rem; font-weight: 700; color: var(--primary-blue); margin: 1rem 0;">
                {{ stats.total_items }}
            </p>
            <p style="color: var(--medium-gray);">Gems in your collection</p>
        </div>

        <div class="card">
            <h3>Purchase Cost</h3>
            <p style="font-size: 2rem; font-weight: 700; color: var(--primary-blue); margin: 1rem 0;">
                ${{ "{:,.2f}".format(stats.total_invested) }}
            </p>
            <p style="font-size: 0.75rem; color: var(--medium-gray); margin: 0.25rem 0;">
                Faceted: ${{ "{:,.2f}".format(stats.faceted_invested) }}
            </p>
            <p style="font-size: 0.75rem; color: var(--medium-gray); margin: 0;">
                Rough: ${{ "{:,.2f}".format(stats.rough_invested) }}
            </p>
            <p style="color: var(--medium-gray); margin-top: 0.5rem;">Gem purchase prices</p>
        </div>

        <div class="card">
            <h3>Shipping Cost</h3>
            <p style="font-size: 2rem; font-weight: 700; color: var(--primary-blue); margin: 1rem 0;">
                ${{ "{:,.2f}".format(stats.total_shipping) }}
            </p>
            <p style="color: var(--medium-gray);">Total shipping</p>
        </div>

        <div class="card">
            <h3>Total Cost</h3>
            <p style="font-size: 2rem; font-weight: 700; color: var(--primary-blue); margin: 1rem 0;">
                ${{ "{:,.2f}".format(stats.total_cost) }}
            </p>
            <p style="font-size: 0.75rem; color: var(--medium-gray); margin: 0.25rem 0;">
                Faceted: ${{ "{:,.2f}".format(stats.faceted_cost) }}
            </p>
            <p style="font-size: 0.75rem; color: var(--medium-gray); margin: 0;">
                Rough: ${{ "{:,.2f}".format(stats.rough_cost) }}
            </p>
            <p style="color: var(--medium-gray); margin-top: 0.5rem;">All-in cost</p>
        </div>

        <div class="card">
            <h3>Total Carats</h3>
            <p style="font-size: 1.5rem; font-weight: 700; color: var(--primary-blue); margin: 1rem 0;">
                Faceted: {{ "{:,.2f}".format(stats.faceted_carats) }}
            </p>
            <p style="font-size: 1.5rem; font-weight: 700; color: var(--primary-blue); margin: 0.5rem 0;">
                Rough: {{ "{:,.2f}".format(stats.rough_carats) }}
            </p>
            <p style="color: var(--medium-gray); margin-top: 0.5rem;">Total weight (not summed)</p>
        </div>

        <div class="card">
            <h3>Total Potential</h3>
            <p style="font-size: 2rem; font-weight: 700; color: var(--primary-blue); margin: 1rem 0;">
                ${{ "{:,.2f}".format(stats.total_potential) }}
            </p>
            <p style="font-size: 0.75rem; color: var(--medium-gray); margin: 0.25rem 0;">
                Faceted: ${{ "{:,.2f}".format(stats.faceted_potential) }}
            </p>
            <p style="font-size: 0.75rem; color: var(--medium-gray); margin: 0;">
                Rough: ${{ "{:,.2f}".format(stats.rough_potential) }}
            </p>
            <p style="color: var(--medium-gray); margin-top: 0.5rem;">Potential value</p>
        </div>
    </div>

    {% if top_gems %}
    <div class="card" style="margin-top: 2rem;">
        <h3>Top Gems by Cost</h3>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Gem Type</th>
                    <th>Total Cost</th>
                </tr>
            </thead>
            <tbody>
                {% for gem_name, total_cost in top_gems %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td><strong>{{ gem_name }}</strong></td>
                    <td>${{ "{:,.2f}".format(total_cost) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}

    <div style="margin-top: 2rem;">
        <a href="{{ url_for('portfolio.index') }}" class="btn" style="background: var(--soft-blue); color: var(--primary-blue); padding: 0.75rem 1.5rem; border-radius: 4px; text-decoration: none; display: inline-block;">‚Üê Back to Portfolio</a>
    </div>
    {% else %}
    <div class="card" style="text-align: center; padding: 3rem;">
        <h3>No data available</h3>
        <p style="margin: 1rem 0;">Add gems to your portfolio to see statistics!</p>
        <a href="{{ url_for('portfolio.add_gem') }}" class="btn btn-primary" style="background: var(--medium-blue); color: white; padding: 0.75rem 1.5rem; border-radius: 4px; text-decoration: none; display: inline-block;">‚ûï Add Your First Gem</a>
    </div>
    {% endif %}
</div>
{% endblock %}
